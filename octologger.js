!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.octologger={})}(this,function(e){"use strict";var u={entry:0,scope:1,group:2,timeMark:3,timeMeasure:4},l=/at\s+([^\s]+)(?:.*?)\(((?:http|file|\/)[^)]+:\d+)\)/,o=/at\s+([^\s]+)(?:.*?)\(((?:http|file|\/)[^)]+:\d+)\)/,a=/^(.*?)(?:\/<)*@(.*?)$/,s=/^()(https?:\/\/.+)/,i=/^(.*?):(\d+)(?::(\d+))?$/;function c(e){if(null==e)return null;var n=e.match(l);if(n||((n=e.match(o))?(n[0]="",n.unshift("")):n=e.match(a)||e.match(s)),n){var t=n[2].match(i),r={fn:n[1].trim()||"<anonymous>",file:"",line:0,column:0};return t&&(r.file=t[1],r.line=parseInt(t[2],10)||0,r.column=parseInt(t[3],10)||0),r}return null}function r(e){if(null==e)return null;for(var n=e.trim().split("\n"),t=[],r=0;r<n.length;r++){var l=c(n[r]);null!==l&&t.push(l)}return t}var p={fn:"<anonymous>",file:"",line:0,column:0};function t(e){var n=r(e.stack),t=n[0]||p;return{name:e.name,message:e.message,fn:t.fn,file:e.fileName||t.file,line:e.lineNumber||t.line,column:e.columnNumber||t.column,stack:n}}var m={error:0,warn:1,info:2,verbose:3,debug:4,log:5},f={};for(var n in m)f[m[n]]=n;var g=/:([^;]+)/g;function d(t,r){return function(e){var n=f[e.level];return r(n,e,{base:t.level[n],label:t.label[n]})}}var v=d({level:{error:"[31m",warn:"[33m",log:"[0m",info:"[34m",verbose:"[35m",debug:"[35m"},label:{error:"[4m",warn:"[4m",log:"[4m",info:"[4m",verbose:"[4m",debug:"[4m",silly:"[4m"}},function(e,n,t){var r=[];return null!==n.badge&&r.push(n.badge),null!==n.label&&r.push(""+t.base+t.label+n.label+"[0m"),null!==n.message&&r.push(""+t.base+n.message),null!==n.detail&&r.push(n.detail),null!==n.meta&&r.push(n.meta.file+":"+n.meta.line+":"+n.meta.column+" ("+n.meta.fn+")"),r.push("[0m"),r}),h=d({level:{error:"color: red;",warn:"color: orange;",log:"color: #333;",info:"color: dodgerblue;",verbose:"color: magenta;",debug:"color: #8b1fdd;"},label:{error:"text-decoration: underline;",warn:"text-decoration: underline;",log:"text-decoration: underline;",info:"text-decoration: underline;",verbose:"text-decoration: underline;",debug:"text-decoration: underline;",silly:"text-decoration: underline;"}},function(e,n,t){var r=[],l=[];if(null!==n.badge&&(r.push("%s"),l.push(n.badge)),null!==n.label&&(r.push("%c%s%c"),l.push(t.label,n.label,t.label.replace(g,": inherit"))),null!==n.message&&(r.push("%c%s"),l.push(t.base,n.message)),null!==n.detail){var o=n.detail,u=o.length;if(null===n.message&&0<=u&&0 in o){r.push("%c"),l.push(t.base);for(var a=0;a<u;a++){var s=o[a];r.push("string"==typeof s?"%s":"%o"),l.push(s)}}else r.push("%o"),l.push(o)}return null!==n.meta&&(r.push("%s"),l.push(n.meta.file+":"+n.meta.line+":"+n.meta.column+" ("+n.meta.fn+")")),l.unshift(r.join(" ")),l}),b="undefined"!=typeof console&&console.log?console:null,y=function(t){return void 0===t&&(t=b),function(e){var n=f[e.level];t[n].apply(t,v(e))}},x=function(n){void 0===n&&(n=b);var t=n.log.apply?n.log:Function.prototype.bind.call(n.log,n);return function(e){t.apply(n,h(e))}},w="undefined"!=typeof window?x:y;function L(e){return e&&e.hasOwnProperty("type")&&e.hasOwnProperty("level")}function E(e,n,t,r,l,o){return void 0===o&&(o=null),{type:u.entry,level:e,badge:n,label:t,message:r,detail:l,meta:o,parent:null,entries:[]}}function O(e){void 0===e&&(e=0);var n=t(new Error).stack;return n.length<=e?null:{fn:n[e].fn,file:n[e].file,line:n[e].line,column:n[e].column}}function k(o,u){return{add:function(e,n){var t,r=u.parent;t=L(e)?e:E(m.log,null,null,e,n),o.meta&&null===t.meta&&(t.meta=O(3)),(t.parent=r).entries.push(t)>o.storeLast&&r.entries.splice(0,1);for(var l=o.output.length;l--;)o.output[l](t);return t}}}function C(e,n,t,r,l,o){return void 0===o&&(o=null),{level:e,type:u.scope,badge:n,label:t,parent:null,message:r,detail:{info:l,state:null},meta:o,entries:[]}}var P=null;function j(e,n){if(null!==e){var t=P,r=e.scope;return(P=e).scope=n,e.scopeContext&&(e.scopeContext.parent=n.scope()),{context:t,scope:r}}P=null}function F(c,p){null==c.meta&&(c.meta=!1),null==c.storeLast&&(c.storeLast=1e3),null==c.output&&(c.output=[]);var e=C(m.info,"üöß","#root",null,null),f={logger:null,parent:e},n=k(c,f);f.logger=n;var g=function(e){for(var n in e)e.hasOwnProperty(n)&&(c[n]=e[n])},t=p({setup:g,levels:m,logger:n});return["clear","scope","setup","getEntries","getLastEntry"].forEach(function(e){if(t.hasOwnProperty(e))throw new SyntaxError('[octologger] "'+e+'" is a reserved identifier')}),t.clear=function(){return e.entries.splice(0,e.entries.length)},t.setup=g,t.getEntries=function(){return e.entries},t.getLastEntry=function(){return e.entries[e.entries.length-1]||null},t.scope=function e(n,t,r){if(0===arguments.length)return this._scopeEntry;null==r&&"function"==typeof t&&(r=t,t=null);var l=L(n)?n:C(m.info,"‚ÜòÔ∏è",null,n,t,c.meta?O(2):null);f.logger.add(l);var o=k(c,{parent:l}),u=p({setup:g,levels:m,logger:o});if(u.scope=e,u._scopeEntry=l,"function"==typeof r){var a=P,s=f.parent,i=f.logger;P={entry:l,scope:u,logger:o,options:c,scopeContext:f},f.parent=l,r(u),P=a,f.parent=s,f.logger=i}return u},t}var M=F({meta:!0,output:[w()]},function(e){var r=e.levels,l=e.logger;return Object.keys(r).reduce(function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];l.add(E(r[t],null,null,null,e))},e},{})});e.EntryTypes=u,e.isLogEntry=L,e.createLogEntry=E,e.getMeta=O,e.createScopeEntry=C,e.getLoggerContext=function(){return P},e.switchLoggerContext=j,e.revertLoggerContext=function(e){j(e.context,e.scope)},e.createLogger=F,e.octlogger=M,e.parseError=t,e.createFormat=d,e.nodeFromat=v,e.browserFormat=h,e.originalConsole=b,e.nodeOutput=y,e.browserOutput=x,e.consoleOutput=w,e.parseStackRow=c,e.parseStack=r,e.LogLevels=m,e.LogLevelsInvert=f,Object.defineProperty(e,"__esModule",{value:!0})});
