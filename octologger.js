!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.octologger={})}(this,function(e){"use strict";var g={entry:0,scope:1,group:2,timeMark:3,timeMeasure:4},m={error:0,warn:1,info:2,verbose:3,debug:4,log:5,success:6},o={};for(var n in m)o[m[n]]=n;var l=/at\s+(?:([^\s]+)(?:.*?)\()?((?:http|file|\/)[^)]+:\d+)\)?/,a=/^(.*?)(?:\/<)*@(.*?)$/,u=/^()(https?:\/\/.+)/,i=/^(.*?):(\d+)(?::(\d+))?$/,c="<anonymous>";function s(e){if(null==e)return null;var n=e.match(l);if(null===n&&(n=e.match(a)||e.match(u)),n){var t=n[2].match(i),r={fn:void 0===n[1]?c:n[1].trim()||c,file:"",line:0,column:0};return t&&(r.file=t[1],r.line=parseInt(t[2],10)||0,r.column=parseInt(t[3],10)||0),r}return null}function r(e){if(null==e)return null;for(var n=e.trim().split("\n"),t=[],r=0;r<n.length;r++){var l=s(n[r]);null!==l&&t.push(l)}return t}var f=/:([^;]+)/g;function t(t,r){return function(e){var n=o[e.level];return r(n,e,{base:t.level[n],label:t.label[n]})}}var p=t({level:{error:"[31m",warn:"[33m",log:"[0m",info:"[34m",success:"[34m",verbose:"[35m",debug:"[35m"},label:{error:"[4m",warn:"[4m",log:"[4m",info:"[4m",success:"[4m",verbose:"[4m",debug:"[4m",silly:"[4m"}},function(e,n,t){var r=[];return null!==n.badge&&r.push(n.badge),null!==n.label&&r.push(""+t.base+t.label+n.label+"[0m"),null!==n.message&&r.push(""+t.base+n.message),null!==n.detail&&r.push(n.detail),null!==n.meta&&r.push(n.meta.file+":"+n.meta.line+":"+n.meta.column+" ("+n.meta.fn+")"),r.push("[0m"),r}),d="text-decoration: underline; font-weight: bold;",v=t({level:{error:"color: red;",warn:"color: orange;",log:"color: #333;",success:"color: #1aaa55;",info:"color: dodgerblue;",verbose:"color: magenta;",debug:"color: #8b1fdd;"},label:{error:d,warn:d,log:d,info:d,success:d,verbose:d,debug:d,silly:d}},function(e,n,t){var r=[],l=[];if(null!==n.badge&&(r.push("%s"),l.push(n.badge)),null!==n.label&&(r.push("%c%s%c "),l.push(t.label+t.base,n.label,t.label.replace(f,": inherit"))),null!==n.message&&(r.push("%c%s "),l.push(t.base,n.message)),null!=n.detail){var o=n.detail,a=o.length;if(null===n.message&&0<=a&&0 in o){r.push("%c"),l.push(t.base);for(var u=0;u<a;u++){var i=o[u];r.push(("string"==typeof i?"%s":"%o")+" "),l.push(i)}}else r.push("%o "),l.push(o)}return null!==n.meta&&(r.push("%s"),l.push(n.meta.file+":"+n.meta.line+":"+n.meta.column+" ("+n.meta.fn+")")),l.unshift(r.join("")),l}),h=Function("return this")(),b="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now,y=h.console,E=h.setTimeout,w=h.clearTimeout,k=h.setInterval,I=h.clearInterval,L=h.setImmediate,x=h.clearImmediate,C=h.requestIdleCallback,T=h.cancelIdleCallback,F=h.requestAnimationFrame,O=h.cancelAnimationFrame,P=Object.freeze({console:y,setTimeout:E,clearTimeout:w,setInterval:k,clearInterval:I,setImmediate:L,clearImmediate:x,requestIdleCallback:C,cancelIdleCallback:T,requestAnimationFrame:F,cancelAnimationFrame:O}),A=function(e){void 0===e&&(e={});var n=e.out,t=void 0===n?y:n,r=e.format,l=void 0===r?p:r;return function(e){if(null!==e){var n=o[6===e.level?m.info:e.level];t[n].apply(t,l(e))}}},j=function(e){void 0===e&&(e={});var n=e.out,a=void 0===n?y:n,t=e.format,u=void 0===t?v:t,i=a.log,c=(a.group,a.groupEnd,a.groupCollapsed,{}),s=[];return function t(e,n){if(null===e)return s.forEach(function(){a.groupEnd()}),void(s.length=0);var r=e.parent,l=s.length;if(!n||!e.printed){if(0<l){for(var o=l;o--&&s[o]!==r;)s[o].printed=!0,a.groupEnd();s.length=o+1}if(e.type===g.scope)"idle"===e.detail.state?(e.printed=!0,i.apply(a,u(e))):(s.push(e),a.group.apply(a,u(e)));else{if(!n&&r.printed&&"#root"!==r.label)return void(c[r.cid]||(c[r.cid]=E(function(){s.forEach(function(){a.groupEnd()}),s.length=0;for(var e=[],n=r;e.unshift(n),"#root"!==(n=n.parent).label;);e.forEach(function(e){a.group.apply(a,u(e))}),r.entries.forEach(function(e){t(e,!0)}),e.forEach(function(){a.groupEnd()})})));e.printed=!0,i.apply(a,u(e))}}}},q="undefined"!=typeof window?j:A,N=0;function S(e){return e&&e.hasOwnProperty("type")&&e.hasOwnProperty("level")}function M(e,n,t,r,l,o){return void 0===o&&(o=null),{cid:++N,type:g.entry,level:e,badge:n,label:t,message:r,detail:l,meta:o,parent:null,entries:[]}}function _(e){void 0===e&&(e=0);var n=Error.stackTraceLimit;Error.stackTraceLimit=e+1;var t=(new Error).stack.split("\n");return Error.stackTraceLimit=n,t.length<=e+1?null:s(t[e+1])}function $(o,a){return{add:function(e,n){var t,r=a.parent;if(t=S(e)?e:M(m.log,null,null,e,n),o.meta&&null===t.meta&&(t.meta=_(3)),(t.parent=r).entries.push(t)>o.storeLast&&r.entries.splice(0,1),!0!==o.silent)for(var l=o.output.length;l--;)o.output[l](t);return t}}}function z(e,n,t,r,l,o,a){return void 0===o&&(o=null),void 0===a&&(a=null),{cid:++N,level:e,type:g.scope,badge:n,label:t,parent:null,message:r,detail:{info:l,state:a},meta:o,entries:[]}}var D=null;function R(){return D}function B(e,n){if(null!==e){var t=D,r=e.scope;return(D=e).scope=n,e.scopeContext&&(e.scopeContext.parent=n.scope()),{context:t,scope:r}}D=null}function G(e){B(e.context,e.scope)}function H(s,f){null==s.silent&&(s.silent=!/^(about:|file:|https?:\/\/localhost\/)/.test(location+"")),null==s.meta&&(s.meta=!1),null==s.storeLast&&(s.storeLast=1e3),null==s.output&&(s.output=[]);var n=z(m.info,"üöß","#root",null,null),p={logger:null,parent:n},t=$(s,p);p.logger=t;var d=function(e){for(var n in e)e.hasOwnProperty(n)&&(s[n]=e[n])},r=f({setup:d,levels:m,logger:t});return["add","clear","scope","setup","getEntries","getLastEntry"].forEach(function(e){if(r.hasOwnProperty(e))throw new SyntaxError('[octologger] "'+e+'" is a reserved identifier')}),r.print=function(){!function t(e){e.printed=!1,e.entries.forEach(function(e){for(var n=s.output.length;n--;)e.printed=!1,s.output[n](e);e.type===g.scope&&t(e)})}(n);for(var e=s.output.length;e--;)s.output[e](null)},r.add=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.add(M(m.log,null,null,null,e))},r.clear=function(){return n.entries.splice(0,n.entries.length)},r.setup=d,r.getEntries=function(){return n.entries},r.getLastEntry=function(){return n.entries[n.entries.length-1]||null},r.scope=function e(n,t,r){if(0===arguments.length)return this._scopeEntry;null==r&&"function"==typeof t&&(r=t,t=null);var l=S(n)?n:z(m.info,null,null,n,t,s.meta?_(2):null);p.logger.add(l);var o=$(s,{parent:l}),a=f({setup:d,levels:m,logger:o});if(a.add=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o.add(M(m.log,null,null,null,e))},a.scope=e,a._scopeEntry=l,"function"==typeof r){var u=D,i=p.parent,c=p.logger;D={entry:l,scope:a,logger:o,options:s,scopeContext:p},p.parent=l,r(a),D=u,p.parent=i,p.logger=c}return a},r}var J={info:"‚ùï",warn:"‚ö†Ô∏è",error:"üõë",verbose:"üîé",debug:"‚ÅâÔ∏è",success:"‚úÖ"},K=H({meta:!0,output:[q()]},function(e){var r=e.levels,l=e.logger;return Object.keys(r).reduce(function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];l.add(M(r[t],J[t]||null,null,null,e))},e},{})}),Q={fn:"<anonymous>",file:"",line:0,column:0};var U={0:{level:m.info,badge:null,label:"success"},1:{level:m.warn,badge:"‚ö†Ô∏è",label:"cancelled"},2:{level:m.error,badge:"‚ùå",label:"failed"}};var V={};function W(l,o,e,r,n,a,u){var i=b(),t={pid:null,start:i,delay:e},c=l.options.meta?_(3):null,s=l.scope.scope(z(m.verbose,"‚è≤",null,'Timer "'+o+'" started',t,c,"idle")),f=function(e,n){var t=+n+2*+(null!=e),r=U[t];s.scope().detail.state=0===t?"completed":1===t?"cancelled":"failed",l.scopeContext.logger.add(M(r.level,r.badge,r.label,'Timer "'+o+'" '+(0===t?"completed successfully":1===t?"cancelled":"failed"),{error:e,cancelled:n,duration:b()-i},c))},p=n(function(e){var n,t=B(l,s);try{if(a)r(e);else if(r.length&&u.length)switch(u.length){case 1:r(u[0]);break;case 2:r(u[0],u[1]);break;case 3:r(u[0],u[1],u[2]);break;case 4:r(u[0],u[1],u[2],u[3]);break;case 5:r(u[0],u[1],u[2],u[3],u[4]);break;default:r.apply(void 0,u)}else r()}catch(e){n=e,h.console.error(e)}f(n,!1),G(t)},e);return t.pid=p,V[o+":"+p]={pid:p,resolve:f,ctx:l,scope:s},p}var X=["Timeout","Interval","Immediate","AnimationFrame","IdleCallback"];function Y(l,o){X.forEach(function(e){var n="AnimationFrame"===e||"IdleCallback"===e,t=(n?"request":"set")+e,r=(n?"cancel":"clear")+e;o(n,t,l[t],r,l[r])})}function Z(e,o,a,u,n,t){e[a]=function(e,n){void 0===n&&(n=0);for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var l=R();return null===l?o?u(e):u.apply(void 0,[e,n].concat(t)):W(l,a,n,e,u,o,t)},e[n]=function(e){!function(e,n,t){t(e);var r=n+":"+e,l=V[r];if(void 0!==l){var o=B(l.ctx,l.scope);l.resolve(null,!0),G(o),delete V[r]}}(e,a,t)},te(e,a),te(e,n)}function ee(o){Y(P,function(e,n,t,r,l){o[n]===t&&Z(o,e,n,t,r,l)})}function ne(o){Y(P,function(e,n,t,r,l){o[n]=t,o[r]=l})}function te(e,n){e[n].toString=function(){return"function "+n+"() { [native code] }"},e[n].native=P[n]}e.EntryTypes=g,e.isLogEntry=S,e.createLogEntry=M,e.getMeta=_,e.createScopeEntry=z,e.getLoggerContext=R,e.switchLoggerContext=B,e.revertLoggerContext=G,e.createLogger=H,e.octologger=K,e.logger=K,e.parseError=function(e){var n=r(e.stack),t=n[0]||Q;return{name:e.name,message:e.message,fn:t.fn,file:e.fileName||t.file,line:e.lineNumber||t.line,column:e.columnNumber||t.column,stack:n}},e.createFormat=t,e.nodeFromat=p,e.browserFormat=v,e.nodeOutput=A,e.browserOutput=j,e.universalOutput=q,e.parseStackRow=s,e.parseStack=r,e.LogLevels=m,e.LogLevelsInvert=o,e.eachTimers=Y,e.patchTimers=ee,e.revertPatchTimers=ne,e.patchNativeAPI=function(e){ee(e)},e.revertPatchNativeAPI=function(e){ne(e)},Object.defineProperty(e,"__esModule",{value:!0})});
